/*! screen-sharing-sample build:0.1.0, production. Copyright(C) 2013-2014 www.OpenFlint.org */!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("eventemitter3"),e=function(){function a(){}return a.CONNECTING=0,a.OPEN=1,a.CLOSING=2,a.CLOSED=3,a}(),d=function(a){function b(a){this.appId=a.appId,this.wsconn=null,this.additionalData={},this.wsServer="ws://127.0.0.1:9431/receiver/"+this.appId}return g(b,a),b.prototype.start=function(){var a,b;if((null!=(a=this.wsconn)?a.readyState:void 0)!==e.CONNECTING&&(null!=(b=this.wsconn)?b.readyState:void 0)!==e.OPEN)return this.wsconn=new WebSocket(this.wsServer),this.wsconn.onopen=function(a){return function(b){return a._onOpen(b)}}(this),this.wsconn.onclose=function(){return function(){return console.info("----------------------------------------------->flingd onclose....")}}(this),this.wsconn.onmessage=function(a){return function(b){return console.info("----------------------------------------------->flingd onmessage....",b.data),b.data?a._onMessage(JSON.parse(b.data)):void 0}}(this),this.wsconn.onerror=function(a){return function(b){return console.info("----------------------------------------------->flingd onerror....",b),a._onError({message:"Underlying websocket is not open",socketReadyState:b.target.readyState})}}(this)},b.prototype.setAdditionalData=function(a,b){return this.additionalData[a]=b,this.send({type:"additionaldata",additionaldata:JSON.stringify(this.additionalData)})},b.prototype.send=function(a){var b,c;return a.appid=this.appId,a=JSON.stringify(a),console.info("----------------------------------------------->flingd send....",a),(null!=(b=this.wsconn)?b.readyState:void 0)===e.OPEN?this.wsconn.send(a):(null!=(c=this.ws)?c.readyState:void 0)===e.CONNECTING?setTimeout(function(b){return function(){return b.send(a)}}(this),50):this._onError({message:"Underlying websocket is not open",socketReadyState:e.CLOSED})},b.prototype._onError=function(a){return this.emit("error",a)},b.prototype._onOpen=function(){return this.send({type:"register"})},b.prototype._onSenderConnected=function(){},b.prototype._onSenderDisconnected=function(){},b.prototype._onMessage=function(a){switch(console.log("_onMessage",a),null!=a?a.type:void 0){case"startheartbeat":return console.log("startheartbeat");case"registerok":return this.localIpAddress=a.service_info.ip[0],this.uuid=a.service_info.uuid,this.deviceName=a.service_info.device_name,this.emit("ready");case"heartbeat":return this.send("ping"===a.heartbeat?{type:"heartbeat",heartbeat:"pong"}:{type:"heartbeat",heartbeat:"ping"});case"senderconnected":return this._onSenderConnected(a);case"senderdisconnected":return this._onSenderDisconnected(a);default:return this.emit("message",a)}},b}(c),b.exports=d},{eventemitter3:3}],2:[function(a){window.FlintReceiverManager=a("./FlintReceiverManager")},{"./FlintReceiverManager":1}],3:[function(a,b){"use strict";function c(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function d(){}d.prototype._events=void 0,d.prototype.listeners=function(a){if(!this._events||!this._events[a])return[];for(var b=0,c=this._events[a].length,d=[];c>b;b++)d.push(this._events[a][b].fn);return d},d.prototype.emit=function(a,b,c,d,e,f){if(!this._events||!this._events[a])return!1;var g,h,i,j=this._events[a],k=j.length,l=arguments.length,m=j[0];if(1===k){switch(m.once&&this.removeListener(a,m.fn,!0),l){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,b),!0;case 3:return m.fn.call(m.context,b,c),!0;case 4:return m.fn.call(m.context,b,c,d),!0;case 5:return m.fn.call(m.context,b,c,d,e),!0;case 6:return m.fn.call(m.context,b,c,d,e,f),!0}for(h=1,g=new Array(l-1);l>h;h++)g[h-1]=arguments[h];m.fn.apply(m.context,g)}else for(h=0;k>h;h++)switch(j[h].once&&this.removeListener(a,j[h].fn,!0),l){case 1:j[h].fn.call(j[h].context);break;case 2:j[h].fn.call(j[h].context,b);break;case 3:j[h].fn.call(j[h].context,b,c);break;default:if(!g)for(i=1,g=new Array(l-1);l>i;i++)g[i-1]=arguments[i];j[h].fn.apply(j[h].context,g)}return!0},d.prototype.on=function(a,b,d){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),this._events[a].push(new c(b,d||this)),this},d.prototype.once=function(a,b,d){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),this._events[a].push(new c(b,d||this,!0)),this},d.prototype.removeListener=function(a,b,c){if(!this._events||!this._events[a])return this;var d=this._events[a],e=[];if(b)for(var f=0,g=d.length;g>f;f++)d[f].fn!==b&&d[f].once!==c&&e.push(d[f]);return this._events[a]=e.length?e:null,this},d.prototype.removeAllListeners=function(a){return this._events?(a?this._events[a]=null:this._events={},this):this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.EventEmitter=d,d.EventEmitter2=d,d.EventEmitter3=d,"object"==typeof b&&b.exports&&(b.exports=d)},{}]},{},[2]);