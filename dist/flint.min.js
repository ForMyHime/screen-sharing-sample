/*! screen-sharing-sample build:0.1.0, production. Copyright(C) 2013-2014 www.OpenFlint.org */!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("eventemitter3"),c=function(a){function b(){this.callid=1,this.temporaryAsyncStorage={},window.addEventListener("message",function(a){return function(b){var c;return"page-script"===(null!=(c=b.data)?c.to:void 0)?a._receive(b.data.payload):void 0}}(this))}return f(b,a),b.instance=null,b.getInstance=function(){return b.instance||(b.instance=new b),b.instance},b.prototype.call=function(a,b,c,d){var e,f;return e=this._genCallId(),f=!0,(c||d)&&(this.temporaryAsyncStorage[e]={success:c,error:d,onetime:f}),this._send({callid:e,method:a,params:b})},b.prototype._send=function(a){return window.postMessage({to:"content-script",payload:a},"*")},b.prototype._genCallId=function(){return this.callid++},b.prototype._receive=function(a){var b;return a.callid&&(void 0===typeof this.temporaryAsyncStorage[a.callid]&&console.log("Nothing stored for call ID: "+a.callid),b=this.temporaryAsyncStorage[a.callid],b&&b[a.status]&&b[a.status](a.content),b&&b.onetime)?delete this.temporaryAsyncStorage[a.callid]:void 0},b}(d),b.exports=c},{eventemitter3:5}],2:[function(a,b){var c,d;c=a("./Bridge"),d=function(){function a(a){this.url=a,this.bridge=c.getInstance(),this._create()}return a.prototype.send=function(a){var b,c;return c=function(){return function(){}}(this),b=function(){return function(){}}(this),this.bridge.call("websocket:send-message",{id:this.id,data:a},c,b)},a.prototype.close=function(){var a,b;return b=function(){return function(){}}(this),a=function(){return function(){}}(this),this.bridge.call("websocket:close",{id:this.id},b,a)},a.prototype._create=function(){var a,b;return b=function(a){return function(b){return a.id=b.id,console.log("Websocket ID : ",b.id),a._pollMessage()}}(this),a=function(){return function(){}}(this),this.bridge.call("websocket:create",{url:this.url},b,a)},a.prototype._pollMessage=function(){var a,b;return b=function(a){return function(b){return a._onMessage(b.data),a._pollMessage()}}(this),a=function(a){return function(b){return"closed"===b.status?a._onClose():a._onError(b)}}(this),this.bridge.call("websocket:get-message",{id:this.id},b,a)},a.prototype._onOpen=function(){return this.onopen?this.onopen():this.emit("open")},a.prototype._onMessage=function(a){return this.onmessage?this.onmessage({data:a}):this.emit("message",a)},a.prototype._onClose=function(){return this.onclose?this.onclose():this.emit("close")},a.prototype._onError=function(a){return this.onerror?this.onerror(a.status):this.emit("error",a.status)},a}(),b.exports=d},{"./Bridge":1}],3:[function(a,b){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("eventemitter3"),d=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return f(b,a),b}(c),b.exports=d},{eventemitter3:5}],4:[function(a){window.Socket=a("./Socket"),window.PrivilegeWebSocket=a("./PrivilegeWebSocket")},{"./PrivilegeWebSocket":2,"./Socket":3}],5:[function(a,b){"use strict";function c(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function d(){}d.prototype._events=void 0,d.prototype.listeners=function(a){if(!this._events||!this._events[a])return[];for(var b=0,c=this._events[a].length,d=[];c>b;b++)d.push(this._events[a][b].fn);return d},d.prototype.emit=function(a,b,c,d,e,f){if(!this._events||!this._events[a])return!1;var g,h,i,j=this._events[a],k=j.length,l=arguments.length,m=j[0];if(1===k){switch(m.once&&this.removeListener(a,m.fn,!0),l){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,b),!0;case 3:return m.fn.call(m.context,b,c),!0;case 4:return m.fn.call(m.context,b,c,d),!0;case 5:return m.fn.call(m.context,b,c,d,e),!0;case 6:return m.fn.call(m.context,b,c,d,e,f),!0}for(h=1,g=new Array(l-1);l>h;h++)g[h-1]=arguments[h];m.fn.apply(m.context,g)}else for(h=0;k>h;h++)switch(j[h].once&&this.removeListener(a,j[h].fn,!0),l){case 1:j[h].fn.call(j[h].context);break;case 2:j[h].fn.call(j[h].context,b);break;case 3:j[h].fn.call(j[h].context,b,c);break;default:if(!g)for(i=1,g=new Array(l-1);l>i;i++)g[i-1]=arguments[i];j[h].fn.apply(j[h].context,g)}return!0},d.prototype.on=function(a,b,d){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),this._events[a].push(new c(b,d||this)),this},d.prototype.once=function(a,b,d){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),this._events[a].push(new c(b,d||this,!0)),this},d.prototype.removeListener=function(a,b,c){if(!this._events||!this._events[a])return this;var d=this._events[a],e=[];if(b)for(var f=0,g=d.length;g>f;f++)d[f].fn!==b&&d[f].once!==c&&e.push(d[f]);return this._events[a]=e.length?e:null,this},d.prototype.removeAllListeners=function(a){return this._events?(a?this._events[a]=null:this._events={},this):this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.EventEmitter=d,d.EventEmitter2=d,d.EventEmitter3=d,"object"==typeof b&&b.exports&&(b.exports=d)},{}]},{},[4]);